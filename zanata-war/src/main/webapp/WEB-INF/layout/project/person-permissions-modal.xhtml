<!--
  Copyright 2015, Red Hat, Inc. and individual contributors
  as indicated by the @author tags. See the copyright.txt file in the
  distribution for a full listing of individual contributors.

  This is free software; you can redistribute it and/or modify it
  under the terms of the GNU Lesser General Public License as
  published by the Free Software Foundation; either version 2.1 of
  the License, or (at your option) any later version.

  This software is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
  Lesser General Public License for more details.

  You should have received a copy of the GNU Lesser General Public
  License along with this software; if not, write to the Free
  Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
  02110-1301 USA, or see the FSF site: http://www.fsf.org.
  -->
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
        xmlns:s="http://jboss.org/schema/seam/taglib"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:zanata="http://java.sun.com/jsf/composite/zanata"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:a4j="http://richfaces.org/a4j"
        xmlns:rich="http://richfaces.org/rich">

<div class="modal" id="#{id}" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal__dialog l--constrain-medium">
    <header class="modal__header">
      <h2 class="modal__title">#{title}</h2>
      <button class="modal__close button--link" data-dismiss="modal">
        <i class="i i--huge i--cancel"></i>
      </button>
    </header>
    <div class="modal__content">
      <h:form>
      <div class="l--pad-all-1">

        <!-- TODO custom user selection mechanism -->
        <h3 class="l--push-top-0">#{msgs['jsf.people.SelectUser']}</h3>
        <label for="add-person-user" class="is-invisible">#{msgs['jsf.User']}</label>
        <input type="text" id="add-person-user" placeholder="Search name or username"/>

        <p class="txt--lead">
          <zanata:person-tile person="#{memberships.person}"/>
          <button class="button button--link link--neutral bx--inline-block l--pad-v-quarter"
              title="#{msgs['jsf.people.RemoveUser']}">
            <i class="i i--small i--cross"></i>
            <span class="is-sr-only">#{msgs['jsf.people.RemoveUser']}</span>
          </button>
        </p>

        <hr/>



        <h3>#{msgs['jsf.ProjectPermissions']}</h3>
        <div class="g--tight">
          <div class="g__item w--1-3">
            <label class="l--push-bottom-0">
              #{msgs['jsf.ProjectPermissions']}</label>
          </div>
          <!-- TODO disabled when #{!s:hasPermission(projectHome.instance, 'manage-members')} -->
          <div class="g__item w--2-3">
            <ul class="list--horizontal">
              <li>
                <zanata:checkbox
                  label="#{msgs['jsf.projectPermissions.ManageTranslators']}"
                  labelStyle="form__checkbox__label js-form__checkbox__label"
                  checked="#{memberships.translationMaintainer}"
                  onValueChanged="function(){}"
                  value="Translation Maintainer"/>
              </li>
              <li>
                <zanata:checkbox
                  label="#{msgs['jsf.projectPermissions.MaintainProject']}"
                  labelStyle="form__checkbox__label js-form__checkbox__label"
                  checked="#{memberships.maintainer}"
                  onValueChanged="function(){}"
                  value="Maintainer"/>
              </li>
            </ul>

            <!-- TODO set username, and change text depending on selection -->
            <!--<p class="txt- -meta l- -push-top-half">-->
              <!--<strong>djansen</strong> will be able to add/remove translators-->
              <!--and reviewers to any language as well as translate or review any-->
              <!--language. They are not able to change project settings.-->
            <!--</p>-->
          </div>
        </div>

        <hr/>

        <h3>Translation Permissions</h3>
        <ul class="list--slat">
          <!-- TODO add filtering for list -->
          <!-- TODO empty list message -->
          <ui:repeat value="#{memberships.localeRoles.toArray()}" var="roles">
            <li>
              <div class="g--tight">
                <div class="g__item w--1-3">
                  <label class="l--push-bottom-0">
                    #{roles.locale.retrieveDisplayName()}
                  </label>
                </div>
                <div class="g__item w--2-3">
                  <ul class="list--horizontal">
                    <li>
                      <zanata:checkbox
                        label="Translate"
                        labelStyle="form__checkbox__label js-form__checkbox__label"
                        onValueChanged=""
                        value="Translator"
                        checked="#{roles.translator}"/>
                        <ui:remove>
                          <input name="german-permission" class="form__checkbox__input js-form__checkbox__input" id="german-permission-translator" value="Translate" type="checkbox"/>
                          <label for="german-permission-translator" class="form__checkbox__label js-form__checkbox__label">Translate</label>
                          <span class="form__checkbox__item js-form__checkbox__item"></span>
                        </ui:remove>
                    </li>
                    <li>
                      <zanata:checkbox
                        label="Review"
                        labelStyle="form__checkbox__label js-form__checkbox__label"
                        onValueChanged=""
                        value="Reviewer"
                        checked="#{roles.reviewer}"/>
                    </li>
                  </ul>
                </div>
              </div>
            </li>
          </ui:repeat>
        </ul>
      </div>

      <footer class="modal__footer l--pad-h-1 l--pad-v-half bg--highest txt--align-right">
        <button class="button--link h--1-1-4 l--push-right-half" data-dismiss="modal">
          #{msgs['jsf.Cancel']}</button>
        <h:commandButton
                action="#{projectHomeAction.savePermissionDialogSelections()}"
                value="ADD">
        </h:commandButton>
      </footer>

    </h:form>

  </div>
  </div>
  <script type="text/javascript">
  //<![CDATA[
    zanata.form.appendCheckboxes(jQuery('##{id}').element);
  //]]>
  </script>
</div>

</ui:composition>
